Conectar Jenkins y GitHub
https://www.blazemeter.com/blog/how-to-integrate-your-github-repository-to-your-jenkins-project


Jenkinsfile para detectar cambios en el jenkinsfile y saltar al otro
    - https://www.bmc.com/blogs/ci-cd-pipeline-setup/ 

Jenkinsfile para cuando se detecta un cambio en el git
pipeline{ ...}
    agent any

    tools{
    - Instalar npm, mocha y mocha-junit-reporter <- npm debería estar ya instalado o inicializado con el archivo de conf package.json
        npm install --global mocha
        npm install -g mocha-junit-reporter
    }

Source - Se comprueba si el git ha cambiado. Arranca el resto del proceso
    -

Build - Se hace la build del código
    - Hacer un pull de GitHub y preparar el código en una carpeta
    - Como estamos usando un javascript, aún no necesita un make.
        - Más adelante se puede usar un script que necesite building, pero por ahora no 
            hace falta.
Tests - Se ejecutan varios tests
    - Pasar un test unitario al script https://unitjs.com/guide/quickstart.html 
        npm test
            (script -> "mocha test --reporter mocha-junit-reporter")
        
    - Si el test unitario funciona continuar (leer test-result.xml)
        - Si no, parar y mandar un correo con el fallo
            https://stackoverflow.com/questions/39720225/send-email-on-jenkins-pipeline-failure 
            https://www.learnitguide.net/2018/08/how-to-configure-jenkins-mail.html
                                            
                                    post {
                                        failure {
                                            mail to: 'team@example.com',
                                                subject: "Failed Pipeline: ${currentBuild.fullDisplayName}",
                                                body: "Something is wrong with ${env.BUILD_URL}"
                                        }
                                    }
    

Deploy - Se envía el código al servidor canario.
    - Push - Si todo ha llegado bien hasta aquí, se hace un push del código en el repositorio.
        - Hacer un push en Jenkins
        - Subir la app al servidor
    - Subir el código a un servidor
        - Explicar que se debe subir primero a un servidor canario y que tras un tiempo, 
            si no ha dado fallos, se puede subir al resto de servidores
